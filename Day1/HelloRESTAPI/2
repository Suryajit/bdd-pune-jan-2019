package org.tektutor;

import io.restassured.*;
import io.restassured.specification.*;
import io.restassured.response.Response;

import static org.junit.Assert.*;
import static org.hamcrest.CoreMatchers.containsString;

import cucumber.api.java.en.Given;
import cucumber.api.java.en.When;
import cucumber.api.java.en.Then;

public class Steps{

	private String endPointURL; 
	private String actualResponse;
	private int statusCode;

	@Given("the Hello REST API is alive")
	public void the_Hello_REST_API_is_alive() {
		endPointURL = "";
	}

	@When("I invoke the Hello REST API endpoint {string}")
	public void i_invoke_the_Hello_REST_API_endpoint(String url) {
		this.endPointURL = url;
	}

	@Then("I expect {string} response message")
	public void i_expect_response_message(String expectedResponse) {
		RestAssured.baseURI = endPointURL;
		RequestSpecification request = RestAssured.given();

		request.header( "Content-type", "application/json" );
		Response response = request.get();

		statusCode = response.getStatusCode();

		assertEquals ( 200, statusCode );	

		actualResponse = response.getBody().asString();

		assertThat( actualResponse, containsString(expectedResponse) );
	}

}
